generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model psy_engine {
  id                 BigInt  @id @default(autoincrement())
  engine_name        String  @db.VarChar(50)
  engine_description String? @db.VarChar(200)
  engine_image       String  @db.VarChar(200)
  state              Int     @default(1) @db.UnsignedTinyInt
}

model psy_experiment {
  id              BigInt    @id @default(autoincrement())
  creator         BigInt?
  experiment_name String?   @db.VarChar(100)
  create_time     DateTime? @default(now()) @db.DateTime(0)
  available       Int?      @default(1) @db.UnsignedTinyInt
  description     String?   @db.Text
  nano_id         String?   @db.VarChar(16)
}

model psy_experiment_logs {
  id                 BigInt    @id @unique(map: "psy_experiment_logs_id_uindex") @default(autoincrement())
  create_time        DateTime? @default(now()) @db.DateTime(0)
  user_experiment_id BigInt?
  prompt             String?   @db.VarChar(1000)
  image              String?   @db.VarChar(100)
  finish_time        DateTime? @db.DateTime(0)
}

model psy_experiment_setting {
  id            BigInt  @id @unique(map: "psy_experiment_setting_id_uindex") @default(autoincrement())
  experiment_id BigInt?
  setting       Json?
  intro         String? @db.LongText
}

model psy_user {
  id            BigInt   @id @default(autoincrement())
  username      String?  @db.VarChar(50)
  password      String?  @db.VarChar(50)
  email         String?  @db.VarChar(50)
  tel           String?  @db.VarChar(15)
  avatar        String?  @db.VarChar(100)
  user_role     String?  @db.VarChar(15)
  create_time   DateTime @default(now()) @db.DateTime(0)
  salt          String?  @db.VarChar(32)
  user_group_id BigInt?
  qualtrics     String?  @db.VarChar(50)
  nano_id       String?  @unique(map: "psy_user_nano_id_uindex") @db.VarChar(16)

  @@index([email], map: "idx_email")
  @@index([username], map: "idx_username")
}

model psy_user_experiments {
  id            BigInt    @id @unique(map: "psy_user_experiments_id_uindex") @default(autoincrement())
  user_id       BigInt?
  nano_id       String?   @unique(map: "psy_user_experiments_nano_id_uindex") @db.VarChar(16)
  experiment_id BigInt?
  type          String?   @default("TRAIL") @db.VarChar(30)
  engine_id     Int?
  start_time    DateTime? @default(now()) @db.DateTime(0)
  finish_time   DateTime? @db.DateTime(0)

  @@index([user_id], map: "idx_user_id")
}

model psy_user_group {
  id         BigInt  @id @default(autoincrement())
  group_name String? @db.VarChar(50)
}

model psy_trail {
  id                 BigInt    @id @default(autoincrement())
  user_experiment_id String?   @db.VarChar(16)
  user_id            BigInt?
  prompt             String?   @db.VarChar(1000)
  state              String?   @db.VarChar(15)
  create_time        DateTime? @default(now()) @db.DateTime(0)
  engine_id          Int?
  image_url          String?   @db.VarChar(200)
  update_time        DateTime? @db.DateTime(0)

  @@index([state], map: "idx_state")
  @@index([user_id], map: "idx_user_id")
  @@index([user_experiment_id], map: "idx_nano_id")
}